<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="icon" href="icon.png" type="image/png">
  <link rel="apple-touch-icon" href="icon.png">
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìˆ˜ì˜ì„ìƒê³„ì‚°ê¸° ì„ì‹œëŸ°ì³</title>
  <style>
    :root {
      --bg:#f8f9fa; --line:#dee2e6; --soft:#f1f3f5; --txt:#212529; --muted:#868e96;
      --blue:#228be6; --red:#fa5252; --green:#37b24d; --gray:#adb5bd;
    }
    * { box-sizing: border-box; }
    body { margin:0; background:var(--bg); color:var(--txt); font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple SD Gothic Neo, Noto Sans KR, sans-serif; }
    header { background:#fff; border-bottom:1px solid var(--line); padding:16px; text-align:center; }
    header h1 { margin:0; font-size:20px; }

    .patient-info { padding:12px; background:#fff; border-bottom:1px solid var(--line); }
    .row { display:flex; gap:12px; }
    .row > div { flex:1; }
    label { display:block; margin:8px 0 4px; font-size:14px; color:#495057; }
    input { width:100%; padding:10px; font-size:16px; border:1px solid #ccc; border-radius:6px; }

    .btnbar { display:flex; justify-content:center; gap:14px; margin:14px auto; max-width:420px; }
    .btn { border:none; border-radius:8px; padding:10px 16px; font-size:15px; color:#fff; cursor:pointer; }
    .btn.confirm { background:var(--green); }
    .btn.reset { background:var(--gray); }

    .tabs { display:flex; background:var(--soft); border-bottom:1px solid var(--line); }
    .tab { flex:1; text-align:center; padding:12px; cursor:pointer; border-right:1px solid var(--line); user-select:none; }
    .tab:last-child { border-right:none; }
    .tab.active { background:#fff; font-weight:700; }

    .container { padding:16px; }
    .section { display:none; }
    .section.active { display:block; }

    .grid { display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:12px; }
    .btn-link { padding:12px; font-size:15px; border:none; border-radius:10px; background:var(--blue); color:#fff; cursor:pointer; transition:transform .03s ease-in; }
    .btn-link:active { transform:translateY(1px); }
    .btn-link.special { background:var(--red); } /* ì—°ê²°ëœ ê³„ì‚°ê¸° = ë¹¨ê°„ ë²„íŠ¼ */

    .notice { margin-top:12px; padding:12px; background:var(--soft); border:1px dashed var(--line); border-radius:8px; color:var(--muted); font-size:13px; }
  </style>

  <!--
    ğŸ”§ ê°œë°œ ë©”ëª¨ (í™”ë©´ ë¹„í‘œì‹œ)
    - ê·œì¹™: "ì—°ê²°ëœ ê³„ì‚°ê¸° = ë¹¨ê°„ ë²„íŠ¼(.special)". ì—°ê²°ì´ ëŠê¸´ ìƒíƒœëŠ” íŒŒë€ìƒ‰ ê¸°ë³¸(.btn-link).
    - ìƒˆ ê³„ì‚°ê¸° ë²„íŠ¼ ì¶”ê°€ ë°©ë²•:
      1) í•´ë‹¹ íƒ­ ë‚´ë¶€ì˜ .grid ì˜ì—­ì— ì•„ë˜ ì˜ˆì‹œì²˜ëŸ¼ ë²„íŠ¼ í•˜ë‚˜ë¥¼ ì¶”ê°€
         <button class="btn-link special" onclick="openCalc('https://example.vercel.app')">ìƒˆ ê³„ì‚°ê¸°</button>
         * ì‹¤ì œ ì—°ê²°ì´ ì—†ìœ¼ë©´ special í´ë˜ìŠ¤ë¥¼ ë¹¼ê³  ê¸°ë³¸ íŒŒë€ìƒ‰ìœ¼ë¡œ ë‘ì„¸ìš”.
      2) ì—°ê²° URLì„ ë„£ê³ , ì‹¤ì œ ë°°í¬ê°€ ì™„ë£Œë˜ë©´ class="btn-link special"ë¡œ ë³€ê²½
    - ë™ì¼ ê³„ì‚°ê¸°ë¥¼ ì—¬ëŸ¬ íƒ­ì—ì„œ í˜¸ì¶œ ê°€ëŠ¥(ì˜ˆ: NaHCOâ‚ƒëŠ” CRIì™€ Bolus ëª¨ë‘ì—ì„œ ë™ì¼ URL í˜¸ì¶œ)
    - ë§í¬ ì—´ê¸° ì •ì±…: ìƒˆ íƒ­, noopener/noreferrer ì ìš© (openCalc í•¨ìˆ˜ ì°¸ê³ )
    - í™˜ì ì •ë³´ ì…ë ¥ë€(window.patientData)ì— ì €ì¥ë˜ì–´ ë‹¤ë¥¸ ê³„ì‚°ê¸°ì—ì„œë„ í™œìš©í•  ì˜ˆì •ì´ë¼ë©´,
      postMessage ë“±ìœ¼ë¡œ ì—°ë™í•˜ëŠ” í™•ì¥ ìŠ¤í™ì„ ì¶”í›„ ì¶”ê°€í•  ìˆ˜ ìˆìŒ(í˜„ì¬ëŠ” ë‹¨ìˆœ ë©”ëª¨ë¦¬ ì €ì¥ë§Œ).
  -->
</head>
<body>
<header style="display:flex; justify-content:center; align-items:center; gap:18px; margin-bottom:6px;">
  <img src="icon.png" alt="icon" style="height:5em; vertical-align:middle;">
  <h1 style="margin:0">ìˆ˜ì˜ì„ìƒê³„ì‚°ê¸° ì„ì‹œëŸ°ì³</h1>
</header>

  <section class="patient-info">
    <div class="row">
      <div>
        <label for="name">í™˜ì ì´ë¦„</label>
        <input id="name" type="text" placeholder="ëƒ¥ëƒ¥ì´" onfocus="this.placeholder=''" />
      </div>
      <div>
        <label for="weight">ì²´ì¤‘ (kg) *</label>
        <input id="weight" type="number" placeholder="í•„ìˆ˜ ì…ë ¥" onfocus="this.placeholder=''" required />
      </div>
    </div>
    <div class="row" style="margin-top:12px;">
      <div>
        <label for="k">ì¹¼ë¥¨ (mEq/L)</label>
        <input id="k" type="number" step="0.1" placeholder="ì˜ˆ: 3.5" />
      </div>
      <div>
        <label for="ca">ì¹¼ìŠ˜ (mg/dL)</label>
        <input id="ca" type="number" step="0.1" placeholder="ì˜ˆ: 9.8" />
      </div>
      <div>
        <label for="hco3">ì¤‘íƒ„ì‚° (mEq/L)</label>
        <input id="hco3" type="number" step="0.1" placeholder="ì˜ˆ: 20" />
      </div>
    </div>
    <div class="btnbar">
      <button class="btn confirm" onclick="handleConfirm()">í™•ì¸</button>
      <button class="btn reset" onclick="handleReset()">ì´ˆê¸°í™”</button>
    </div>
  </section>

  <nav class="tabs">
    <div class="tab active" onclick="showTab(0)">ğŸ’§ ì¼ë°˜ìˆ˜ì•¡</div>
    <div class="tab" onclick="showTab(1)">ğŸ’‰ ì•½ë¬¼ CRI</div>
    <div class="tab" onclick="showTab(2)">âš¡ ì•½ë¬¼ Bolus</div>
  </nav>

  <main class="container">
    <!-- íƒ­ 1: ì¼ë°˜ìˆ˜ì•¡ (ì›ë˜ ìœ„ì¹˜ ìœ ì§€) -->
    <section class="section active">
      <div class="grid">
        <!-- ê¸°ì¡´ ë¹„ì—°ê²° ë²„íŠ¼ ì˜ˆì‹œ -->
        <button class="btn-link">íƒˆìˆ˜êµì • ë° KCLë³´ì •</button>

        <!-- âœ… PPN: ì›ë˜ ì¼ë°˜ìˆ˜ì•¡ íƒ­ì— ìœ„ì¹˜ â†’ ì—°ê²° ìƒíƒœ(ë¹¨ê°•) -->
        <button class="btn-link special" onclick="openCalc('https://ppn-calculator.vercel.app')">RER/PPN ê³„ì‚°ê¸°</button>

        <!-- âœ… ìˆ˜í˜ˆ: ì›ë˜ ì¼ë°˜ìˆ˜ì•¡ íƒ­ì— ìœ„ì¹˜ â†’ ì—°ê²° ìƒíƒœ(ë¹¨ê°•) -->
        <button class="btn-link special" onclick="openCalc('https://blootranscal.vercel.app')">ìˆ˜í˜ˆê³„ì‚°ê¸°</button>

        <!-- âœ… ìƒˆë¡œ ì¶”ê°€: BPM counter -->
        <button class="btn-link special" onclick="openCalc('https://bpm-test-t564.vercel.app')">BPM counter</button>
      </div>
      <p class="notice"> í˜„ì¬ëŠ” ë¹¨ê°„ìƒ‰ë²„íŠ¼ë§Œ ì‘ë™í•©ë‹ˆë‹¤.</p>
    </section>

    <!-- íƒ­ 2: CRI (ì›ë˜ ìœ„ì¹˜ ìœ ì§€) -->
    <section class="section">
      <p style="margin:0 0 8px; font-weight:700;">ğŸ’‰ ì•½ë¬¼ ì„ íƒ</p>
      <div class="grid">
        <!-- âœ… NaHCOâ‚ƒ CRI: ì—¬ê¸°ì—ì„œ ì—°ê²° â†’ ë¹¨ê°• -->
        <button class="btn-link special" onclick="openCalc('https://nahco3.vercel.app')">NaHCOâ‚ƒ </button>

        <!-- ì´í•˜ ìë¦¬ ìœ ì§€ìš© ë²„íŠ¼ë“¤ (ë¯¸ì—°ê²° íŒŒë‘) -->
        <button class="btn-link">Calcium Gluconate</button>
        <!-- âœ… Fentanyl CRI: ì™„ì„±ëœ ê³„ì‚°ê¸° ì—°ê²° â†’ ë¹¨ê°• -->
        <button class="btn-link special" onclick="openCalc('https://fentanyl-cri-calculator.vercel.app')">Fentanyl</button>
       <button class="btn-link special" onclick="openCalc('https://ne-calculator.vercel.app/')">Norepinephrine</button>
        <button class="btn-link">Dobutamine</button>
        <button class="btn-link">Dopamine</button>
        <button class="btn-link">Vasopressin</button>
        <button class="btn-link">Metoclopramide</button>
        <button class="btn-link">Insulin</button>
        <button class="btn-link">ë²”ìš© CRI ê³„ì‚°ê¸°</button>
      </div>
    </section>

    <!-- íƒ­ 3: Bolus (ì›ë˜ ìœ„ì¹˜ ìœ ì§€) -->
    <section class="section">
      <p style="margin:0 0 8px; font-weight:700;">âš¡ Bolus ì•½ë¬¼ ê³„ì‚°</p>
      <div class="grid">
        
        <button class="btn-link">ë²”ìš© í¬ì„ ê³„ì‚°ê¸°</button>
        <button class="btn-link">ë²”ìš© ì•½ë¬¼ ìš©ëŸ‰ ê³„ì‚°ê¸°</button>

<!-- âœ… ê²°ê³¼ê°€ í‘œì‹œë  ìë¦¬ -->
<div id="bolus-results" class="bolus-results"></div>
</section>

<style>
  .bolus-results { margin-top:16px; font-size:14px; line-height:1.55; }
  .bolus-results .drug { margin-bottom:10px; }
  .bolus-results hr { border:none; border-top:1px dashed #ccc; margin:10px 0; }
</style>

<script>
  function renderBolusResults(){
    const el = document.getElementById('bolus-results');
    if (!el) return;

    const W = parseFloat(document.getElementById('weight').value);
    if (!W || isNaN(W)) {
      el.innerHTML = '<div class="notice">âš ï¸ ì²´ì¤‘ì„ ë¨¼ì € ì…ë ¥í•˜ê³  [í™•ì¸]ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>';
      return;
    }

    const rows = [];
    const push = (name, vol, meta) => {
      rows.push(
        `<div class="drug">ğŸ’‰ <b>${name}</b>â€ƒvolume : ${vol} mL<br>${meta}</div>`
      );
    };

    // 3ê°œ
    push('Glycopyrrolate', ((0.011*W)/0.2).toFixed(2), '(0.2mg/mL, 0.011â€“0.033 mg/kg, IV/IM/SC) / Dose : 0.011 mg/kg');
    push('Atropine', ((0.02*W)/0.5).toFixed(2), '(0.5mg/mL, 0.02â€“0.04 mg/kg, IV/IM/SC) / Dose : 0.02 mg/kg');
    push('Epinephrine', ((0.01*W)/1).toFixed(2), '(1mg/mL, 0.01â€“0.02 mg/kg, IV/IM/ET) / Dose : 0.01 mg/kg');
    rows.push('<hr>');

    // 4ê°œ
    push('Midazolam', ((0.1*W)/5).toFixed(2), '(5mg/mL, 0.1â€“0.3 mg/kg, IV/IM/IN) / Dose : 0.1 mg/kg');
    push('Diazepam', ((0.2*W)/5).toFixed(2), '(5mg/mL, 0.1â€“0.5 mg/kg, IV/PR) / Dose : 0.2 mg/kg');
    push('Fentanyl', ((3*W)/50).toFixed(2), '(50Âµg/mL, 2â€“5 Âµg/kg, IV/CRI) / Dose : 3 Âµg/kg');
    push('Naloxone', ((0.01*W)/0.4).toFixed(2), '(0.4mg/mL, 0.01 mg/kg, IV/IM/SC) / Dose : 0.01 mg/kg');
    rows.push('<hr>');

    // 2ê°œ
    push('Xylazine (emetic)', ((0.44*W)/23.32).toFixed(2), '(23.32mg/mL, 0.5â€“1.0 mg/kg, IM) / Dose : 0.44 mg/kg');
    push('Yohimbine', ((0.1*W)/10).toFixed(2), '(10mg/mL, 0.1â€“0.2 mg/kg, IV) / Dose : 0.1 mg/kg');
    rows.push('<hr>');

    // 1ê°œ
    push('Dexamethasone-SP', ((0.1*W)/5).toFixed(2), '(5mg/mL, 0.1â€“0.5 mg/kg, IV/IM) / Dose : 0.1 mg/kg');
    rows.push('<hr>');

    // 4ê°œ
    push('Sodium Bicarbonate', (1*W).toFixed(2), '(1mEq/mL, 1â€“2 mEq/kg, IV slow) / Dose : 1 mEq/kg');
    push('Calcium Gluconate', (1.5*W).toFixed(2), '(10% calcium gluconate (=9.3mg/mL elemental Ca), 5â€“15 mg/kg, IV slow) / Dose : 15 mg/kg');
    push('Magnesium sulfate', 'â€“', '(0.1g/mL, ~0.037â€“0.075 g/kg, IV slow) / Dose : â€“');
    push('Dextrose 50%', ((0.5*W)/0.5).toFixed(2), '(0.5g/mL, 0.5â€“1.0 g/kg, IV diluted) / Dose : 0.5 g/kg');
    rows.push('<hr>');

    // 2ê°œ
    push('Mannitol 20%', ((0.5*W)/0.2).toFixed(2), '(0.2g/mL, 0.25â€“1.0 g/kg, IV over 15â€“30min) / Dose : 0.5 g/kg');
    push('Hetastarch', (15*W).toFixed(2), '(6%, 10â€“20 mL/kg, IV slow) / Dose : 15 mL/kg');

    el.innerHTML = rows.join('');
  }

  // ê¸°ì¡´ handleConfirm() ëì— ì¶”ê°€
  const _oldHandleConfirm = handleConfirm;
  handleConfirm = function(){
    _oldHandleConfirm();
    renderBolusResults();
  }

  // reset ì‹œ ê²°ê³¼ë„ ì§€ìš°ê¸°
  const _oldHandleReset = handleReset;
  handleReset = function(){
    _oldHandleReset();
    const el = document.getElementById('bolus-results');
    if (el) el.innerHTML = '';
  }
</script>
        
              <ul style="margin-top: 0;">
        <li>Glycopyrrolate</li>
        <li>Atropine</li>
        <li>Epinephrine</li>
        <li><span style="white-space:nowrap">Sodium Bicarbonate (NaHCOâ‚ƒ)</span></li>
        <li><span style="white-space:nowrap">Calcium Gluconate</span></li>
        <li>xylazine/yohimbin</li>
        <li>fentanyl/naloxon</li>
        <li>mannitol</li>
      </div>
    </section>
  </main>

  <script>
    const tabs = document.querySelectorAll('.tab');
    const sections = document.querySelectorAll('.section');

    function showTab(i){
      tabs.forEach((t,idx)=>t.classList.toggle('active', idx===i));
      sections.forEach((s,idx)=>s.classList.toggle('active', idx===i));
    }

    function handleConfirm(){
      const data = {
        name: (document.getElementById('name').value||'ì´ë¦„ ì—†ìŒ').trim(),
        weight: parseFloat(document.getElementById('weight').value)||null,
        k: parseFloat(document.getElementById('k').value)||null,
        ca: parseFloat(document.getElementById('ca').value)||null,
        hco3: parseFloat(document.getElementById('hco3').value)||null,
      };
      window.patientData = data; // ì¶”í›„ í™•ì¥ìš©
      document.querySelectorAll('.patient-info input').forEach(el=>{
        el.style.transition='box-shadow .25s, background-color .25s';
        el.style.boxShadow='0 0 0 2px #40c05740';
        el.style.backgroundColor='#f8ffef';
        setTimeout(()=>{ el.style.boxShadow='none'; el.style.backgroundColor=''; }, 700);
      });
    }

    function handleReset(){
      ['name','weight','k','ca','hco3'].forEach(id=>document.getElementById(id).value='');
      window.patientData = null;
    }

    function openCalc(url){
      window.open(url, '_blank', 'noopener,noreferrer');
    }
  </script>
</body>
</html>
